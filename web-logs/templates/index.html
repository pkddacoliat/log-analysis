{% extends "bootstrap/base.html" %}

{% block metas %} <meta http-equiv="refresh" content="30"> {% endblock %}

{% block title %} Log Analysis {% endblock %}

{% block content %}
<div class="container-fluid">
    <h1>Security Alerts</h1>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th> Alert Time </th>
                <th> IP Address </th>
                <th> Client Request </th>
                <th> Time Processed </th>
                <th> Status Code </th>
                <th> Object Size </th>
            </tr>
        </thead>
        <tbody>
            {% for x in alerts %}
            <tr>
                <td> {{ x.split()[0].decode("utf-8") }} </td>
                <td> {{ x.split()[1].decode("utf-8") }} </td>
                <td> {{ x.split()[6].decode("utf-8") + " " + x.split()[7].decode("utf-8") + " " + x.split()[8].decode("utf-8") }} </td>
                <td> {{ x.split()[4][1:].decode("utf-8") }} </td>
                <td> {{ x.split()[9].decode("utf-8") }} </td>
                <td> {{ x.split()[10].decode("utf-8") }} </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
