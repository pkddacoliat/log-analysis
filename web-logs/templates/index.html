{% extends "bootstrap/base.html" %}

{% block metas %} <meta http-equiv="refresh" content="70"> {% endblock %}

{% block title %} Log Analysis {% endblock %}

{% block content %}
<div class="container-fluid">
    <h1>Security Alerts</h1>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th> Alert Time </th>
                <th> IP Address </th>
                <th> Client Request </th>
                <th> Time Processed </th>
                <th> Status Code </th>
                <th> Object Size </th>
            </tr>
        </thead>
        <tbody>
            {% for key, value in alerts.items() %}
            <tr>
                <td> {{ key[:20].decode("utf-8") }} </td>
                <td> {{ value.split()[0].decode("utf-8") }} </td>
                <td> {{ value.split()[5].decode("utf-8") + " " + value.split()[6].decode("utf-8") + " " + value.split()[7].decode("utf-8") }} </td>
                <td> {{ value.split()[3][1:].decode("utf-8") }} </td>
                <td> {{ value.split()[8].decode("utf-8") }} </td>
                <td> {{ value.split()[9].decode("utf-8") }} </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
